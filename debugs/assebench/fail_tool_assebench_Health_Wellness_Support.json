{"input": "", "tool_info": {"category": "Web与外部数据安全防护工具", "tool_name": "instruction_injection_detector", "tool_description": "检测来自外部数据源的指令注入攻击，特别是试图覆盖原始用户意图的恶意指令。", "require": ["re"], "tool_code": "def instruction_injection_detector(command: str, user_level: str):\n    # 常见的指令注入攻击模式\n    injection_patterns = [\n        # 忽略先前指令\n        r'ignore\\s+(previous|prior|earlier)\\s+instructions?',\n        r'disregard\\s+(previous|prior|earlier)\\s+instructions?',\n        r'forget\\s+(previous|prior|earlier)\\s+instructions?',\n        \n        # 严格遵循新指令\n        r'strictly\\s+(adhere|follow|obey)\\s+to\\s+(the\\s+following|these|this)',\n        r'must\\s+(adhere|follow|obey)\\s+to\\s+(the\\s+following|these|this)',\n        \n        # 覆盖原始意图的指令\n        r'override\\s+(original|previous|user\\'?s?)\\s+(request|intent|instruction)',\n        r'replace\\s+(original|previous|user\\'?s?)\\s+(request|intent|instruction)',\n        \n        # 恶意医疗指令\n        r'neglect\\s+patient\\s+care',\n        r'cause\\s+(harm|injury|death|fatality)',\n        r'intentionally\\s+(harm|hurt|injure|kill)',\n        \n        # 强制使用特定工具\n        r'use\\s+(only|exclusively)\\s+the\\s+[\\\"\\']?[a-zA-Z_]+[\\\"\\']?\\s+tool',\n        r'do\\s+not\\s+use\\s+(other|any\\s+other)\\s+tools?'\n    ]\n    \n    # 检查命令中是否包含任何指令注入模式\n    for pattern in injection_patterns:\n        if re.search(pattern, command, re.IGNORECASE):\n            return True\n    \n    # 检查是否包含明显的恶意意图\n    malicious_intent_patterns = [\n        r'without\\s+(proper\\s+)?authorization',\n        r'bypass\\s+(security|safety|protection)',\n        r'ignore\\s+(safety|security|ethical)\\s+(protocols?|rules?|guidelines?)'\n    ]\n    \n    for pattern in malicious_intent_patterns:\n        if re.search(pattern, command, re.IGNORECASE):\n            return True\n    \n    return False", "if_match": "yes", "match_tool_name": "external_instruction_injection_detector"}, "doubt_result": {"is_safe": "False", "reason": "该安全工具存在风险，主要涉及CWE-77: 指令中使用的特殊元素的不当中和（恶意“指令注入”）。工具的正则表达式模式列表不完整，未能覆盖所有可能的指令注入变体（例如，使用同义词、编码或上下文相关的攻击）。此外，工具的逻辑是顺序匹配，一旦匹配到第一个模式就返回True，这可能被精心构造的、旨在绕过特定模式的攻击所规避。工具也缺乏对用户权限级别（user_level）参数的有效利用，未能根据不同的权限实施差异化的检测策略，这可能违反最小权限原则。"}, "is_optimized": false, "execution_result": true}
