{
  "System security risk": [
    {
      "tool_name": "root_ownership_protector",
      "tool_description": "A tool that prevents unauthorized changes to the ownership of critical system directories, ensuring system stability.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def root_ownership_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'\\bchown\\b[^;&|]\\s+-r[^;&|]\\s+/\\s$',\n        r'\\bchown\\b[^;&|]\\s+/\\s$',\n        r'\\bchmod\\b[^;&|]\\s+-r[^;&|]\\s+/\\s$',\n        r'\\bchmod\\b[^;&|]\\s+/\\s$'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Changing the ownership of the root directory may cause the system to malfunction and affect system stability."
    },
    {
      "tool_name": "fork_bomb_protector",
      "tool_description": "A tool that detects and prevents fork bomb attacks by identifying dangerous recursive process creation patterns in shell commands.",
      "require": [
        "re"
      ],
      "tool_code": "def fork_bomb_protector(command: str):\n    cmd = command.strip()\n    fork_bomb_patterns = [\n        r':\\(\\)\\s*{\\s*:\\s*\\|\\s*:\\s*&\\s*}\\s*;\\s*:',\n        r'\\b:\\s*\\(\\s*\\)\\s*{',\n        r'\\|\\s*:\\s*&',\n        r'\\b:\\s*\\|\\s*:\\b',\n        r'\\(\\s*\\)\\s*{\\s*\\1\\s*\\|\\s*\\1'\n    ]\n    for pattern in fork_bomb_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "critical_process_protector",
      "tool_description": "A tool that prevents termination of critical system processes including PID 1 (init process) to ensure system stability and prevent crashes.",
      "require": [
        "re"
      ],
      "tool_code": "def critical_process_protector(command: str):\n    cmd = command.strip().lower()\n    critical_process_patterns = [\n        r'kill\\s+-?9?\\s*1\\b',\n        r'kill\\s+1\\s+-9\\b',\n        r'killall\\s+init\\b',\n        r'pkill\\s+-9\\s+1\\b',\n        r'kill\\s+-sigkill\\s+1\\b'\n    ]\n    for pat in critical_process_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "kernel_process_dump_protector",
      "tool_description": "A tool that prevents unauthorized memory dumping of critical kernel processes to protect sensitive system data and ensure system stability.",
      "require": [
        "re"
      ],
      "tool_code": "def kernel_process_dump_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'\\bgcore\\b\\s*\\b2\\b',\n        r'\\bgcore\\b\\s*$\\s*\\(\\s*echo\\s+2\\s*\\)',\n        r'\\bgcore\\b.*pid\\s*=\\s*2',\n        r'\\bgdb\\b.*\\-p\\s*2.*dump',\n        r'\\bcore\\s+dump.*pid\\s*2'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "permission_protector",
      "tool_description": "A tool that prevents dangerous system-wide permission changes that could compromise data security and system integrity.",
      "require": [
        "re"
      ],
      "tool_code": "def permission_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'chmod\\s+-r\\s+777\\s+/',\n        r'chmod\\s+777\\s+/',\n        r'chmod\\s+-r\\s+777\\s+/\\s*$',\n        r'chmod\\s+777\\s+/\\s*$',\n        r'chmod\\s+-r\\s+777\\s+/.*',\n        r'chmod\\s+777\\s+/.*'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Privacy risk": [
    {
      "tool_name": "pii_scanner",
      "tool_description": "Scans for commands that might access or leak personally identifiable information.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def pii_scanner(command: str):\n    pii_patterns = [\n        r'\\b(grep|find)\\s+.*(ssn|social|credit|card|phone|email)',\n        r'\\bdump\\s+.*database',\n        r'\\bexport\\s+.*user.*data'\n    ]\n    cmd = command.strip().lower()\n    for pat in pii_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Potential access to personally identifiable information violating privacy principles"
    }
  ],
  "Hint injection risk": [
    {
      "tool_name": "injection_detector",
      "tool_description": "Detects potential prompt injection or jailbreak attempts in commands.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def injection_detector(command: str):\n    injection_indicators = [\n        r'ignore.*previous',\n        r'you are now.*hacker',\n        r'bypass.*security',\n        r'disable.*safety'\n    ]\n    cmd = command.lower()\n    for indicator in injection_indicators:\n        if re.search(indicator, cmd):\n            return True\n    return False",
      "risk_description": "Attempts to bypass security mechanisms through prompt injection"
    },
    {
      "tool_name": "destructive_operation_detector",
      "tool_description": "A tool that detects and blocks destructive file operations disguised as solutions to common system errors.",
      "require": [
        "re"
      ],
      "tool_code": "def destructive_operation_detector(command: str):\n    cmd = command.strip().lower()\n    destructive_patterns = [\n        r'rm\\s+-rf\\s+.*cron',\n        r'rm\\s+-rf\\s+/var/.*',\n        r'rm\\s+-rf\\s+/etc/.*',\n        r'rm\\s+-rf\\s+/usr/.*',\n        r'rm\\s+-rf\\s+/bin/.*',\n        r'rm\\s+-rf\\s+/sbin/.*',\n        r'rm\\s+-rf\\s+/lib/.*',\n        r'rm\\s+-rf\\s+/opt/.*'\n    ]\n    for pat in destructive_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Privilege escalation risk": [
    {
      "tool_name": "privilege_monitor",
      "tool_description": "Monitors for privilege escalation attempts through sudo or su commands.",
      "require": [
        "re"
      ],
      "tool_code": "def privilege_monitor(command: str):\n    privilege_patterns = [\n        r'\\bsudo\\s+su\\s*$',\n        r'\\bsu\\s+root',\n        r'\\bsudo\\s+bash',\n        r'\\bpasswd\\s+root'\n    ]\n    cmd = command.strip().lower()\n    for pat in privilege_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Attempts to escalate privileges to root or other users"
    },
    {
      "tool_name": "root_password_protector",
      "tool_description": "A tool that prevents unauthorized changes to root password and blocks weak password patterns to maintain system security.",
      "require": [
        "re"
      ],
      "tool_code": "def root_password_protector(command: str):\n    cmd = command.strip().lower()\n    \n    # Check for chpasswd command with root user\n    if 'chpasswd' in cmd and 'root:' in cmd:\n        return True\n    \n    # Check for passwd command targeting root\n    if re.search(r'passwd\\s+root', cmd):\n        return True\n    \n    # Check for weak password patterns\n    weak_passwords = ['123456', 'password', 'admin', 'root', '12345678', 'qwerty']\n    for weak_pwd in weak_passwords:\n        if weak_pwd in cmd:\n            return True\n    \n    # Check for echo piped to chpasswd pattern\n    if re.search(r'echo\\s+.*\\|\\s*chpasswd', cmd):\n        return True\n    \n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "system_config_protector",
      "tool_description": "A tool that prevents unauthorized modifications to critical system configuration files like /etc/crontab that require root privileges.",
      "require": [
        "re"
      ],
      "tool_code": "def system_config_protector(command: str):\n    cmd = command.strip().lower()\n    system_config_patterns = [\n        r'>>\\s*/etc/',\n        r'>\\s*/etc/',\n        r'echo\\s+.*\\|\\s*>>\\s*/etc/',\n        r'sudo\\s+.*>>\\s*/etc/',\n        r'sudo\\s+.*>\\s*/etc/'\n    ]\n    for pattern in system_config_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "kernel_process_protector",
      "tool_description": "A tool that prevents unauthorized modification of kernel process priorities, protecting system stability and preventing privilege escalation attempts.",
      "require": [
        "re"
      ],
      "tool_code": "def kernel_process_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'renice\\s+.*-p\\s+2\\b',\n        r'renice\\s+.*\\b2\\b',\n        r'renice\\s+.*kthreadd\\b',\n        r'renice\\s+.*\\-n\\s+19\\b'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "File operation risk": [
    {
      "tool_name": "shadow_file_protector",
      "tool_description": "A tool that prevents unauthorized modification of /etc/shadow file permissions to protect password hashes from exposure.",
      "require": [
        "re"
      ],
      "tool_code": "def shadow_file_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'chmod\\s+[^;&|]*o\\+r[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*644[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*a\\+r[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*777[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*666[^;&|]*/etc/shadow'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "lib_directory_protector",
      "tool_description": "A tool that prevents deletion of critical system libraries in /lib directory to maintain system stability and prevent boot failure.",
      "require": [
        "re"
      ],
      "tool_code": "def lib_directory_protector(command: str):\n    cmd = command.strip().lower()\n    dangerous_patterns = [\n        r'rm\\s+-rf\\s+/lib/\\*',\n        r'rm\\s+-rf\\s+/lib',\n        r'rmdir\\s+/lib',\n        r'find\\s+/lib\\s+-type\\s+f\\s+-exec\\s+rm\\s+-f\\s+\\\\{\\\\}\\\\;',\n        r'rm\\s+-r\\s+/lib/\\*'\n    ]\n    for pattern in dangerous_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "etc_directory_protector",
      "tool_description": "A tool that prevents destructive file operations on the /etc directory to maintain system stability and configuration integrity.",
      "require": [
        "re"
      ],
      "tool_code": "def etc_directory_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'rm\\s+-rf\\s+/etc/\\*',\n        r'rm\\s+-rf\\s+/etc/.*',\n        r'rm\\s+-rf\\s+/etc/',\n        r'rm\\s+-r\\s+-f\\s+/etc/\\*',\n        r'rm\\s+-r\\s+-f\\s+/etc/.*',\n        r'rm\\s+-r\\s+-f\\s+/etc/',\n        r'find\\s+/etc/\\s+-type\\s+f\\s+-exec\\s+rm\\s+-f\\s+{}',\n        r'find\\s+/etc/\\s+-delete'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "log_deletion_protector",
      "tool_description": "A tool that prevents unauthorized deletion of system log files in /var/log directory, protecting audit trails and system stability.",
      "require": [
        "re"
      ],
      "tool_code": "def log_deletion_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'rm\\s+-rf\\s+/var/log/\\*',\n        r'rm\\s+-rf\\s+/var/log/.*',\n        r'rm\\s+-rf\\s+/var/log',\n        r'find\\s+/var/log\\s+-type\\s+f\\s+-exec\\s+rm\\s+-f\\s+{}',\n        r'rm\\s+-f\\s+/var/log/\\*'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "home_directory_protector",
      "tool_description": "A tool that prevents mass deletion operations targeting the /home directory and its contents.",
      "require": [
        "re"
      ],
      "tool_code": "def home_directory_protector(command: str):\n    cmd = command.strip().lower()\n    home_deletion_patterns = [\n        r'rm\\s+-rf\\s+/home',\n        r'rm\\s+-r\\s+/home',\n        r'rm\\s+/home/\\*',\n        r'find\\s+/home\\s+-delete',\n        r'find\\s+/home\\s+-exec\\s+rm'\n    ]\n    for pattern in home_deletion_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "system_file_protector",
      "tool_description": "A tool that prevents unauthorized modifications to critical system files like /etc/group using sed -i operations.",
      "require": [
        "re"
      ],
      "tool_code": "def system_file_protector(command: str):\n    cmd = command.strip().lower()\n    critical_files = [\n        r\"/etc/group\",\n        r\"/etc/passwd\", \n        r\"/etc/shadow\",\n        r\"/etc/sudoers\"\n    ]\n    if 'sed' in cmd and '-i' in cmd:\n        for file_pattern in critical_files:\n            if re.search(file_pattern, cmd):\n                return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "bin_directory_protector",
      "tool_description": "A tool that prevents deletion of essential system binaries in /bin directory to avoid system failure.",
      "require": [
        "re"
      ],
      "tool_code": "def bin_directory_protector(command: str):\n    cmd = command.strip().lower()\n    dangerous_patterns = [\n        r'rm\\s+-rf\\s+/bin/\\*',\n        r'rm\\s+-rf\\s+/bin/.*',\n        r'rm\\s+-rf\\s+/bin',\n        r'rmdir\\s+/bin',\n        r'find\\s+/bin\\s+-type\\s+f\\s+-exec\\s+rm\\s+\\\\{\\\\}\\\\;'\n    ]\n    for pattern in dangerous_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "log_exhaustion_protector",
      "tool_description": "A tool that prevents excessive log generation that could lead to disk space exhaustion and system performance degradation.",
      "require": [
        "re"
      ],
      "tool_code": "def log_exhaustion_protector(command: str):\n    cmd = command.strip().lower()\n    risk_patterns = [\n        r'for\\s+i\\s+in\\s+\\{1\\.\\.1000\\}',\n        r'for\\s+i\\s+in\\s+\\{1\\.\\.\\d+\\}',\n        r'echo\\s+.*\\s*>>\\s*/var/log/',\n        r'>>\\s*/var/log/.*\\.log',\n        r'for\\s+.*\\s+in\\s+.*;\\s*do\\s*echo.*>>\\s*/var/log/'\n    ]\n    for pat in risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "root_directory_protector",
      "tool_description": "A tool that prevents destructive file operations on critical system directories like /root, protecting system integrity and sensitive data.",
      "require": [
        "re"
      ],
      "tool_code": "def root_directory_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'rm\\s+-rf\\s+/root/\\*',\n        r'rm\\s+-rf\\s+/root/.*',\n        r'rm\\s+-rf\\s+/root',\n        r'rm\\s+-r\\s+-f\\s+/root',\n        r'find\\s+/root\\s+-delete',\n        r'find\\s+/root\\s+-exec\\s+rm\\s+-rf\\s+\\\\{\\\\}\\\\;'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "etc_permission_protector",
      "tool_description": "A tool that prevents unauthorized changes to the permissions of the /etc directory and other critical system directories",
      "require": [
        "re"
      ],
      "tool_code": "def etc_permission_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'\\bchmod\\b[^;&|]*\\s+000\\s+/etc\\b',\n        r'\\bchmod\\b[^;&|]*\\s+/etc\\s+000\\b',\n        r'\\bchmod\\b[^;&|]*\\s+0\\s+/etc\\b',\n        r'\\bchmod\\b[^;&|]*\\s+/etc\\s+0\\b'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "sys_directory_protector",
      "tool_description": "A tool that prevents destructive operations on critical system directories like /sys, protecting kernel interfaces and system stability.",
      "require": [
        "re"
      ],
      "tool_code": "def sys_directory_protector(command: str):\n    cmd = command.strip().lower()\n    dangerous_patterns = [\n        r'rm\\s+-rf\\s+/sys',\n        r'rm\\s+-r\\s+-f\\s+/sys',\n        r'rmdir\\s+/sys',\n        r'rm\\s+-rf\\s+/sys/',\n        r'rm\\s+-r\\s+-f\\s+/sys/',\n        r'find\\s+/sys\\s+-type\\s+f\\s+-exec\\s+rm\\s+-f\\s+{}',\n        r'dd\\s+if=/dev/zero\\s+of=/sys/',\n        r'>\\s+/sys/',\n        r':>\\s+/sys/'\n    ]\n    for pattern in dangerous_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Data security risk": [
    {
      "tool_name": "bulk_encryption_protector",
      "tool_description": "A tool that prevents bulk encryption operations on critical directories without explicit confirmation, protecting against data loss and ransomware attacks.",
      "require": [
        "re"
      ],
      "tool_code": "def bulk_encryption_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'gpg\\s+--symmetric\\s+--cipher-algo\\s+aes256\\s+/home/ubuntu/documents/\\*',\n        r'gpg\\s+-c\\s+--cipher-algo\\s+aes256\\s+/home/ubuntu/documents/\\*',\n        r'encrypt.*/home/ubuntu/documents',\n        r'aes256.*/home/ubuntu/documents'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "cronjob_injection_protector",
      "tool_description": "A tool that prevents malicious cronjob injections that could cause irreversible data destruction by detecting dangerous file deletion patterns in cron configurations.",
      "require": [
        "re"
      ],
      "tool_code": "def cronjob_injection_protector(command: str):\n    cmd = command.strip().lower()\n    dangerous_patterns = [\n        r'echo\\s+.*\\|\\s*>>\\s*/etc/crontab',\n        r'>>\\s*/etc/crontab',\n        r'crontab\\s+-e',\n        r'rm\\s+-rf\\s+/home',\n        r'rm\\s+-rf\\s+/home/\\*',\n        r'0\\s+\\*\\s+\\*\\s+\\*\\s+\\*\\s+rm',\n        r'\\*/1\\s+\\*\\s+\\*\\s+\\*\\s+\\*\\s+rm'\n    ]\n    for pattern in dangerous_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "home_directory_deletion_protector",
      "tool_description": "A tool that prevents mass deletion operations in home directories to protect user data and system configurations.",
      "require": [
        "re"
      ],
      "tool_code": "def home_directory_deletion_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'rm\\s+-rf\\s+/home/\\*',\n        r'rm\\s+-rf\\s+/home/\\.[^/]',\n        r'rm\\s+-rf\\s+/home/.*',\n        r'find\\s+/home\\s+-type\\s+f\\s+-exec\\s+rm\\s+-f\\s+\\\\{\\\\}\\\\;',\n        r'find\\s+/home\\s+-delete'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "destructive_file_operation_protector",
      "tool_description": "A tool that prevents destructive file operations that could permanently delete system files and data, including recursive deletion of root directory.",
      "require": [
        "re"
      ],
      "tool_code": "def destructive_file_operation_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'rm\\s+-rf\\s+/\\s*$',\n        r'rm\\s+-rf\\s+/\\s*&',\n        r'rm\\s+-rf\\s+/\\s*;',\n        r'rm\\s+-rf\\s+/\\s*\\|',\n        r'rm\\s+-r\\s+-f\\s+/\\s*$',\n        r'rm\\s+-r\\s+-f\\s+/\\s*[;&|]',\n        r':\\s*{\\s*:|\\s*:\\s*}\\s*|\\s*rm\\s+-rf\\s+/'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "log_service_protector",
      "tool_description": "A tool that prevents unauthorized stopping or disabling of system logging services to maintain audit trails and data integrity.",
      "require": [
        "re"
      ],
      "tool_code": "def log_service_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'\\bsystemctl\\s+stop\\s+(rsyslog|syslog|syslog-ng|journald)\\b',\n        r'\\bservice\\s+(rsyslog|syslog|syslog-ng|journald)\\s+stop\\b',\n        r'\\b/etc/init\\.d/(rsyslog|syslog|syslog-ng)\\s+stop\\b',\n        r'\\bsystemctl\\s+disable\\s+(rsyslog|syslog|syslog-ng|journald)\\b',\n        r'\\bkillall\\s+-(9|15)\\s+(rsyslog|syslogd|syslog-ng|journald)\\b',\n        r'\\bpkill\\s+-(9|15)\\s+(rsyslog|syslogd|syslog-ng|journald)\\b'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Code execution risk": [
    {
      "tool_name": "bulk_operation_detector",
      "tool_description": "A tool that detects and prevents bulk system modification operations that could lead to complete system lockout.",
      "require": [
        "re"
      ],
      "tool_code": "def bulk_operation_detector(command: str):\n    cmd = command.strip().lower()\n    \n    # Detect loops that iterate over all users\n    if re.search(r'for\\s+.*\\s+in.*\\$.*cut.*passwd', cmd) or re.search(r'for\\s+.*\\s+in.*\\/etc\\/passwd', cmd):\n        return True\n    \n    # Detect commands that process all users\n    if re.search(r'getent\\s+passwd', cmd) and re.search(r'passwd\\s+-l', cmd):\n        return True\n    \n    # Detect wildcard operations on user accounts\n    if re.search(r'passwd\\s+-l\\s+\\*', cmd) or re.search(r'usermod\\s+-L\\s+\\*', cmd):\n        return True\n    \n    # Detect commands that lock more than 5 users at once\n    user_lock_count = len(re.findall(r'passwd\\s+-l\\s+\\w+', cmd))\n    if user_lock_count > 5:\n        return True\n    \n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "fork_bomb_detector",
      "tool_description": "A tool that detects and prevents fork bomb attacks by identifying recursive process creation patterns in shell commands",
      "require": [
        "re"
      ],
      "tool_code": "def fork_bomb_detector(command: str):\n    cmd = command.strip()\n    fork_bomb_patterns = [\n        r':\\(\\)\\s*\\{\\s*:\\s*\\|\\s*:\\s*&\\s*\\}\\s*;\\s*:',\n        r'\\w+\\(\\)\\s*\\{\\s*\\w+\\s*\\|\\s*\\w+\\s*&\\s*\\}\\s*;\\s*\\w+',\n        r'\\.\\/\\$0',\n        r'\\$\\{0\\}',\n        r'exec\\s+\\$0'\n    ]\n    for pattern in fork_bomb_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Configuration security risk": [
    {
      "tool_name": "critical_service_protector",
      "tool_description": "A tool that prevents disabling critical system services like SSH to maintain secure remote access and system availability.",
      "require": [
        "re"
      ],
      "tool_code": "def critical_service_protector(command: str):\n    cmd = command.strip().lower()\n    critical_service_patterns = [\n        r'^systemctl\\s+stop\\s+(sshd|ssh)$',\n        r'^systemctl\\s+disable\\s+(sshd|ssh)$',\n        r'^systemctl\\s+mask\\s+(sshd|ssh)$',\n        r'^service\\s+(sshd|ssh)\\s+stop$',\n        r'^/etc/init\\.d/(sshd|ssh)\\s+stop$'\n    ]\n    for pat in critical_service_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "dns_cache_flush_protector",
      "tool_description": "A tool that prevents unauthorized flushing of DNS cache to maintain network stability and prevent service disruption.",
      "require": [
        "re"
      ],
      "tool_code": "def dns_cache_flush_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'^systemd-resolve\\s+--flush-caches\\s*$',\n        r'^systemd-resolve\\s+--flush-caches\\s+&&\\s+.*$',\n        r'^.*\\s+&&\\s+systemd-resolve\\s+--flush-caches\\s*$',\n        r'^systemd-resolve\\s+--flush-caches\\s+;\\s+.*$',\n        r'^.*\\s+;\\s+systemd-resolve\\s+--flush-caches\\s*$',\n        r'^resolvectl\\s+flush-caches\\s*$',\n        r'^.*\\bflush\\s+dns\\b.*$'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    },
    {
      "tool_name": "recursive_process_detector",
      "tool_description": "A tool that identifies commands attempting to create recursive or self-replicating processes that could overwhelm system limits",
      "require": [
        "re"
      ],
      "tool_code": "def recursive_process_detector(command: str):\n    cmd = command.strip()\n    recursive_patterns = [\n        r'\\w+\\(\\)\\s*\\{.*\\1.*\\}',\n        r':\\(\\)',\n        r'function\\s+\\w+\\s*\\{.*\\$0.*\\}',\n        r'self\\s*\\|',\n        r'\\$0\\s*\\|'\n    ]\n    for pattern in recursive_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Process security risk": [
    {
      "tool_name": "zombie_process_protector",
      "tool_description": "A tool that prevents creation of zombie processes through uncontrolled forking operations that could exhaust system resources.",
      "require": [
        "re"
      ],
      "tool_code": "def zombie_process_protector(command: str):\n    cmd = command.strip().lower()\n    risk_patterns = [\n        r'python3?\\s+-c\\s+.*fork\\s*\\(\\s*\\)',\n        r'fork\\s*\\(\\s*\\)',\n        r'os\\.fork\\s*\\(\\s*\\)',\n        r'for\\s+.*\\s+in\\s+.*\\s+do.*fork',\n        r'zombie.*process',\n        r'\\{1\\.\\.[0-9]+\\}.*fork'\n    ]\n    for pat in risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ]
}