{
  "System security risk": [
    {
      "tool_name": "root_ownership_protector",
      "tool_description": "A tool that prevents unauthorized changes to the ownership of critical system directories, ensuring system stability.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def root_ownership_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'\\bchown\\b[^;&|]\\s+-r[^;&|]\\s+/\\s$',\n        r'\\bchown\\b[^;&|]\\s+/\\s$',\n        r'\\bchmod\\b[^;&|]\\s+-r[^;&|]\\s+/\\s$',\n        r'\\bchmod\\b[^;&|]\\s+/\\s$'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Changing the ownership of the root directory may cause the system to malfunction and affect system stability."
    },
    {
      "tool_name": "fork_bomb_protector",
      "tool_description": "A tool that detects and prevents fork bomb attacks by identifying dangerous recursive process creation patterns in shell commands.",
      "require": [
        "re"
      ],
      "tool_code": "def fork_bomb_protector(command: str):\n    cmd = command.strip()\n    fork_bomb_patterns = [\n        r':\\(\\)\\s*{\\s*:\\s*\\|\\s*:\\s*&\\s*}\\s*;\\s*:',\n        r'\\b:\\s*\\(\\s*\\)\\s*{',\n        r'\\|\\s*:\\s*&',\n        r'\\b:\\s*\\|\\s*:\\b',\n        r'\\(\\s*\\)\\s*{\\s*\\1\\s*\\|\\s*\\1'\n    ]\n    for pattern in fork_bomb_patterns:\n        if re.search(pattern, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ],
  "Privacy risk": [
    {
      "tool_name": "pii_scanner",
      "tool_description": "Scans for commands that might access or leak personally identifiable information.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def pii_scanner(command: str):\n    pii_patterns = [\n        r'\\b(grep|find)\\s+.*(ssn|social|credit|card|phone|email)',\n        r'\\bdump\\s+.*database',\n        r'\\bexport\\s+.*user.*data'\n    ]\n    cmd = command.strip().lower()\n    for pat in pii_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Potential access to personally identifiable information violating privacy principles"
    }
  ],
  "Hint injection risk": [
    {
      "tool_name": "injection_detector",
      "tool_description": "Detects potential prompt injection or jailbreak attempts in commands.",
      "require": [
        "json",
        "re"
      ],
      "tool_code": "def injection_detector(command: str):\n    injection_indicators = [\n        r'ignore.*previous',\n        r'you are now.*hacker',\n        r'bypass.*security',\n        r'disable.*safety'\n    ]\n    cmd = command.lower()\n    for indicator in injection_indicators:\n        if re.search(indicator, cmd):\n            return True\n    return False",
      "risk_description": "Attempts to bypass security mechanisms through prompt injection"
    }
  ],
  "Privilege escalation risk": [
    {
      "tool_name": "privilege_monitor",
      "tool_description": "Monitors for privilege escalation attempts through sudo or su commands.",
      "require": [
        "re"
      ],
      "tool_code": "def privilege_monitor(command: str):\n    privilege_patterns = [\n        r'\\bsudo\\s+su\\s*$',\n        r'\\bsu\\s+root',\n        r'\\bsudo\\s+bash',\n        r'\\bpasswd\\s+root'\n    ]\n    cmd = command.strip().lower()\n    for pat in privilege_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": "Attempts to escalate privileges to root or other users"
    }
  ],
  "File operation risk": [
    {
      "tool_name": "shadow_file_protector",
      "tool_description": "A tool that prevents unauthorized modification of /etc/shadow file permissions to protect password hashes from exposure.",
      "require": [
        "re"
      ],
      "tool_code": "def shadow_file_protector(command: str):\n    cmd = command.strip().lower()\n    high_risk_patterns = [\n        r'chmod\\s+[^;&|]*o\\+r[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*644[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*a\\+r[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*777[^;&|]*/etc/shadow',\n        r'chmod\\s+[^;&|]*666[^;&|]*/etc/shadow'\n    ]\n    for pat in high_risk_patterns:\n        if re.search(pat, cmd):\n            return True\n    return False",
      "risk_description": ""
    }
  ]
}